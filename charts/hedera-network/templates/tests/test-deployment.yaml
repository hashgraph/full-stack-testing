apiVersion: v1
kind: Pod
metadata:
  name: "network-test"
  annotations:
    "helm.sh/hook": test
spec:
  serviceAccountName: pod-monitor
  volumes:
    - name: test-volume
      configMap:
        name: test-cm
        defaultMode: 0777 # we need the test files to be executable
  containers:
    - name: tester
      image: bitnami/kubectl:latest
      volumeMounts:
        - mountPath: /scripts/test.sh
          name: test-volume
          subPath: test.sh
      command:
        - "/bin/bash"
        - "-c"
        - /scripts/test.sh
        #- "while true;do echo sleeping; sleep 10;done"
  restartPolicy: Never
